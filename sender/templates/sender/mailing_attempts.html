{% extends 'sender/base.html' %}
{% block content%}

{% include "sender/includes/inc_sender_header.html" with title=title only%}

{% if success_message %}
<div class="alert alert-{% if success_message|slice:1 == 'Р'%}success{% else %}danger{% endif %} alert-dismissible fade show"
     role="alert">
    {{ success_message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>

</div>
{% endif %}

<div class="row">
    <div class="col-12 mt-2">
        <div class="container p-5 mt-2 rounded bg-primary-subtle">
            {% if newsletters %}
                {% include "sender/includes/table.html" with headers=headers items=newsletters actions=actions %}
            {% else %}
                <h4 class="text-center">У вас пока нет ни одной рассылки</h4>
            {% endif %}
        </div>
    </div>
</div>

<div class="row bg-secondary text-white text-center rounded pd-3">
    <h4>
        Результаты отправки
    </h4>
</div>
<div class="container-fluid bg-dark rounded pd-5">
    {% for mailing in mailings %}

    <ul class="list-group">
        <li class="{% if forloop.first %}list-group-item text-bg-primary text-wrap{% else %}list-group-item{% endif %}">
            {{ mailing.attempt_date|date:'d-m-Y H:i' }} {{ mailing.newsletter }} {{ mailing.exc_state }} Лог операции:
            {{ mailing.server_response }}
        </li>
    </ul>

    {% endfor %}
</div>
{% endblock %}

{% for message in messages %}
<div class="alert alert-info alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endfor %}